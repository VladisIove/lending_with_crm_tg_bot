<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Undershop.ua</title>
    
    <link href="https://fonts.googleapis.com/css?family=Russo+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css">
    <!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">-->
    <link rel="stylesheet" href="{{url( 'static', filename='css/nav.css')}}">
    <link rel="stylesheet" href="{{url( 'static', filename='css/header.css')}}">
    <link rel="stylesheet" href="{{url( 'static', filename='css/main.css')}}">
    <link rel="stylesheet" href="{{url( 'static', filename='css/carousel.css')}}">
    <link rel="stylesheet" href="{{url( 'static', filename='css/footer.css')}}">    
    <link rel="stylesheet" href="{{url( 'static', filename='css/cart.css')}}">

    <link href='chosen/chosen.min.css' rel='stylesheet' type='text/css'>
    <script src='chosen/chosen.jquery.min.js' type='text/javascript'></script>
</head>
<body>
<nav>
    <div class="logo"><h4>Undershop.ua</h4></div>
    <ul class="nav-links">
        <li><a href="#tshirts">Футболки</a></li>
        <li><a href="#hoodies">Толстовки</a></li>
        <li><a href="#shirt">Майки</a></li>
        <li><a id="cartBtn">Корзина</a></li>
    </ul>
    <div class="burger">
        <div class="line1"></div>
        <div class="line2"></div>
        <div class="line3"></div>
    </div>
</nav>   
<header>
    <div class="img-overlay"></div>
    <div class="header-text">
        <h1>До конца скидки осталось:</h4>
        <hr>
        <p1 id="timer"></p1>
    </div>
</header>  
<main>
    <h1 class="catalog">Каталог</h1>
    <div class="main">
      <span id="tshirts"></span>
      {%for  cl in clothes %}

        <div class="product-cart">   
            <div class="container">
                <div id="card-{{cl.id}}" class="card">
                    <div class="front">
                        <img class="cart-image" id="img-{{cl.id}}" src="{{cl.img}}" alt="">
                    </div>
                    <div class="back">
                        <form action="" method="POST" class="fast_form">
                            <input type="text" class="input" name="name-{{cl.id}}" placeholder="Имя">
                            <input type="text" class="input" name="phone-{{cl.id}}" placeholder="Номер телефона">
                            <a class="neon neon-fast-form" onclick="fastCartFunction('{{cl.id}}', '{{cl.price}}', )">               
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>Оформить заказ
                            </a>
                            </span>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="options">
                <h1 class="name" id="name-{{cl.id}}">{{cl.name}}</h1>
                <p class="price">
                  {% if cl.old_price %}
                    <span class="old_price">{{cl.old_price}}</span>
                    {% endif %}
                    <span class="new_price" > <span id="price-{{cl.id}}">{{cl.price}}</span> uah</span>
                </p>
                <p class="description">{{cl.description}}</p>
                <p class="count">Осталось: {{cl.count}}</p>
                <p class="size" >Размеры: <span id="size-{{cl.id}}">{% for size in cl.size %}{{size.name_size}} {%endfor%}</span> </p>
                <p class="color" >Цвет: <span id="color-{{cl.id}}">{% for color in cl.color %}{{color.name_color}} {%endfor%}</span> </p>
                <span>
                    <a  onclick="flipCardFunction('{{cl.id}}')" class="neon neon-fast">
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                        Быстрый заказ
                    </a>
  
                    </span>
            </div>
        </div>
      {%endfor%}
    </div>

</main>
<section >
    <div class="carousel-container">
        <i class="fas fa-arrow-left" id="prevBtn"></i>
        <i class="fas fa-arrow-right" id="nextBtn"></i>
        <div class="carousel-slide">
            <img id="lastClone" src="https://maikasoft.com.ua/image/catalog/razmer/tolstovka_unisex.jpg" alt="">
            <img src="https://maikasoft.com.ua/image/catalog/razmer/tolstovka_unisex.jpg">
            <img src="https://maikasoft.com.ua/image/catalog/razmer/futbolkam.jpg"  alt="">
            <img src="https://maikasoft.com.ua/image/catalog/razmer/tolstovka_unisex.jpg" alt="">
            <img src="https://maikasoft.com.ua/image/catalog/razmer/futbolkam.jpg" alt="">
            <img src="https://maikasoft.com.ua/image/catalog/razmer/tolstovka_unisex.jpg" alt="">
            <img id="firstClone" src="https://maikasoft.com.ua/image/catalog/razmer/tolstovka_unisex.jpg" alt="">
        </div>
    </div>
</section>


<footer>
    <div class="inner-footer">
        <div class="footer-items about">
            <h1>О нас</h1>
            <p>Расписали, разложили по полочкам, разжевали. 
              Конечно нет ничего идеального, но мы идем на компромиссы во многих нюансах. 
              Будут вопросы или пожелания, ждем писем или звонков. Спасибо тем, кто дочитал 
              (мы бы психанули еще в начале).</p>   
        </div>
        <div class="footer-items contacs">
            <h1>Контакты:</h1>
            <div class="border"></div>
           <ul>
               <li><i class="fa fa-phone" aria-hidden="true"></i> *номер телефона*</li>
               <li><i class="fa fa-map-marker" aria-hidden="true"> Украина, г.Киев</i></li>
               <li><i class="fa fa-envelope" aria-hidden="true"> dddd@gmail.com</i></li>
           </ul>
        </div>
        <div class="social-media footer-items">
            <h1>Наши соц. сети:</h1>
            <div class="border"></div>
            <div class="media-links">
                <a href=""><i class="fab fa-facebook" aria-hidden="true"></i></a>
            <a href=""><i class="fab fa-instagram" aria-hidden="true"></i></a>
            <a href=""><i class="fab fa-telegram"></i></div>
            </div>

        </div>
    </div>
</footer>

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="{{url( 'static', filename='scripts/nav.js')}}" type="text/javascript" ></script>
<script src="{{url( 'static', filename='scripts/header.js')}}" type="text/javascript"></script>
<script src="{{url( 'static', filename='scripts/main.js')}}" type="text/javascript"></script>
<script src="{{url( 'static', filename='scripts/carousel.js')}}"></script>
<script src="{{url( 'static', filename='scripts/cart.js')}}" ></script>

<script>  
function fastCartFunction(id_clothes, price){
  let name = document.querySelector(`[name="name-${id_clothes}"]`).value;
  let phone = document.querySelector(`[name="phone-${id_clothes}"]`).value;
  if(phone.search(/^[\+]?[0-9]{10,13}$/)==-1){
    return;
  }
  $.ajax({
    url: `{{ url ('create_fast_order') }}`,
    type: "POST",
    async: true,
    data: {
      'name': name,
      'phone': phone,
      'type_order': 1,
      'id_clothes': id_clothes,
      'price': price
    },
    success: function(req){
      if(req.created){
        //Спасибо за заказа, наш менеджер свяжется в скоре с вами 
        let form = document.querySelector(`[name="name-${id_clothes}"]`).parentElement;
        form.innerHTML = `<div class="complete-message message-${id_clothes}"><p>Спасибо за заказа, наш менеджер свяжется в скоре с вами. Наши соц.сети:<br> </p>
          <a>Instagram</a><br><a>Facebooke</a></div>`
      }
    }
  });
}

function cartFunction(){
  let name = document.querySelector(`[name="name"]`).value;
  let phone = document.querySelector(`[name="phone"]`).value;
  let email = document.querySelector(`[name="email"]`).value;
  let surname = document.querySelector(`[name="surname"]`).value;
  let city = document.querySelector(`[name="phone"]`).value;
  let address_novoi_poshti = document.querySelector(`[name="address_novoi_poshti"]`).value;
  let price = document.getElementById('cart-total');
  if(phone.search(/^[\+]?[0-9]{10,13}$/)==-1){
    return;
  }
  if(email.search(/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i)==-1){
    return;
  }
  $.ajax({
    url: `{{ url ('crete_order_by_cart') }}`,
    type: "POST",
    async: true,
    data: {
      'order': {
        'name': name,
        'phone': phone,
        'type_order': 1,
        'price': price,
        'address_novoi_poshti': address_novoi_poshti,
        'city': city,
        'surname': surname,
        'email': email
      }

      
    },
    success: function(req){
      console.log(req)
    }
  });
}
</script>
</body>
</html>